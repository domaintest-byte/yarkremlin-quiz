class Quiz {
    constructor() {
        this.questions = [
            {
                "question": "–ö—Ç–æ –∏–∑–æ–±—Ä–∞–∂—ë–Ω –Ω–∞ –ø–æ—Ä—Ç—Ä–µ—Ç–µ? –ö–∞–∫–æ–π –≤–∫–ª–∞–¥ –æ–Ω –≤–Ω—ë—Å –≤ –∏—Å—Ç–æ—Ä–∏—é –Ø—Ä–æ—Å–ª–∞–≤–ª—è?",
                "image": "./source/vopros (1).jpg",
                "answers": [
                    {"text": "–í–æ–ª–∫–æ–≤ –§—ë–¥–æ—Ä –ì—Ä–∏–≥–æ—Ä—å–µ–≤–∏—á"},
                    {"text": "–ú–µ–ª—å–≥—É–Ω–æ–≤ –ê–ª–µ–∫—Å–µ–π –ü–µ—Ç—Ä–æ–≤–∏—á"},
                    {"text": "–î–µ–º–∏–¥–æ–≤ –ü–∞–≤–µ–ª –ì—Ä–∏–≥–æ—Ä—å–µ–≤–∏—á"},
                    {"text": "–í–∞—Ö—Ä–∞–º–µ–µ–≤ –ò–≤–∞–Ω –ê–ª–µ–∫—Å–∞–Ω–¥—Ä–æ–≤–∏—á"}
                ],
                "correctIndex": 2,
                "explanation": "–î–µ–º–∏–¥–æ–≤ –ü–∞–≤–µ–ª –ì—Ä–∏–≥–æ—Ä—å–µ–≤–∏—á (1738‚Äì1821) ‚Äî —É—á—ë–Ω—ã–π-–Ω–∞—Ç—É—Ä–∞–ª–∏—Å—Ç, –º–µ—Ü–µ–Ω–∞—Ç –∏ –æ—Å–Ω–æ–≤–∞—Ç–µ–ª—å –Ø—Ä–æ—Å–ª–∞–≤—Å–∫–æ–≥–æ —É—á–∏–ª–∏—â–∞ –≤—ã—Å—à–∏—Ö –Ω–∞—É–∫ (–î–µ–º–∏–¥–æ–≤—Å–∫–æ–≥–æ –ª–∏—Ü–µ—è)."
            },
            {
                "question": "–û—Ç–≥–∞–¥–∞–π—Ç–µ –∑–∞–≥–∞–¥–∫—É: –ù–µ —Ö–æ–ª—Å—Ç, –Ω–æ —Ä–∞—Å–ø–∏—Å–∞–Ω —É–∑–æ—Ä–æ–º, –ù–µ —â–∏—Ç, –Ω–æ –æ–±–µ—Ä–µ–≥–∞–ª –¥–æ–º. –û–≥–Ω—ë–º —Ä–æ–∂–¥—ë–Ω, –≤–æ–¥–æ–π —Ö—Ä–∞–Ω–∏–º, –ö—Ç–æ —É–∑–Ω–∞–ª –º–µ–Ω—è? –ì–æ–≤–æ—Ä–∏–º!",
                "image": "./source/vopros (2).jpg",
                "answers": [
                    {"text": "–û–∫–Ω–æ"},
                    {"text": "–°–æ—Å—É–¥"},
                    {"text": "–ò–∑—Ä–∞–∑–µ—Ü"},
                    {"text": "–ü–µ—á—å"}
                ],
                "correctIndex": 2,
                "explanation": "–ò–∑—Ä–∞–∑–µ—Ü ‚Äî –∫–µ—Ä–∞–º–∏—á–µ—Å–∫–∞—è –ø–ª–∏—Ç–∫–∞ –¥–ª—è –æ–±–ª–∏—Ü–æ–≤–∫–∏ —Å—Ç–µ–Ω –∏ –ø–µ—á–µ–π, —Å–æ–∑–¥–∞–≤–∞–µ–º–∞—è –æ–±–∂–∏–≥–æ–º (–æ–≥–Ω—ë–º) –∏ –∑–∞—â–∏—â–∞–µ–º–∞—è –≥–ª–∞–∑—É—Ä—å—é (–≤–æ–¥–æ–π)."
            },
            {
                "question": "–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –æ —á—ë–º –∏–¥—ë—Ç —Ä–µ—á—å: ¬´‚Ä¶¬ª - –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö –¥–µ–Ω–µ–∂–Ω—ã—Ö –µ–¥–∏–Ω–∏—Ü, –≤–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–≤—à–∞—è—Å—è –≤ 1534 –≥–æ–¥—É.",
                "image": "./source/vopros (3).jpg",
                "answers": [
                    {"text": "–ì—Ä–æ—à"},
                    {"text": "–ß–µ—à—É–π–∫–∞"},
                    {"text": "–ü–æ–ª—É—à–∫–∞"},
                    {"text": "–ó–ª–∞—Ç–Ω–∏–∫"}
                ],
                "correctIndex": 1,
                "explanation": "–ß–µ—à—É–π–∫–∞ ‚Äî –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–∞—è –º–æ–Ω–µ—Ç–∞, –ø–æ–ª—É—á–∏–≤—à–∞—è –Ω–∞–∑–≤–∞–Ω–∏–µ –∏–∑-–∑–∞ —Ñ–æ—Ä–º—ã, –ø–æ—Ö–æ–∂–µ–π –Ω–∞ —Ä—ã–±—å—é —á–µ—à—É—é. –í–ø–µ—Ä–≤—ã–µ –ø–æ—è–≤–∏–ª–∞—Å—å –≤ 1534 –≥–æ–¥—É."
            },
            {
                "question": "–ß—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ –Ω–∞ –≥–µ—Ä–±–µ –Ø—Ä–æ—Å–ª–∞–≤–ª—è?",
                "image": "",
                "answers": [
                    {"text": "–î–≤–µ –∑–æ–ª–æ—Ç—ã–µ —Å–µ–ª—å–¥–∏"},
                    {"text": "–°–µ—Ä–µ–±—Ä—è–Ω—ã–π –æ–ª–µ–Ω—å"},
                    {"text": "–ó–æ–ª–æ—Ç–∞—è –≥–∞–ª–µ—Ä–∞"},
                    {"text": "–ú–µ–¥–≤–µ–¥—å —Å —Å–µ–∫–∏—Ä–æ–π"}
                ],
                "correctIndex": 3,
                "explanation": "–ú–µ–¥–≤–µ–¥—å —Å —Å–µ–∫–∏—Ä–æ–π ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª –Ø—Ä–æ—Å–ª–∞–≤–ª—è, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å –ª–µ–≥–µ–Ω–¥–æ–π –æ–± –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞."
            },
            {
                "question": "–ö–∞–∫–æ–π –≥–æ–¥ —Å—á–∏—Ç–∞–µ—Ç—Å—è –≥–æ–¥–æ–º –æ—Å–Ω–æ–≤–∞–Ω–∏—è –Ø—Ä–æ—Å–ª–∞–≤–ª—è?",
                "image": "./source/vopros (5).jpg",
                "answers": [
                    {"text": "1040"},
                    {"text": "1010"},
                    {"text": "1030"},
                    {"text": "1020"}
                ],
                "correctIndex": 1,
                "explanation": "–Ø—Ä–æ—Å–ª–∞–≤–ª—å –±—ã–ª –æ—Å–Ω–æ–≤–∞–Ω –≤ 1010 –≥–æ–¥—É –∫–Ω—è–∑–µ–º –Ø—Ä–æ—Å–ª–∞–≤–æ–º –ú—É–¥—Ä—ã–º, —á—Ç–æ —Å—Ç–∞–ª–æ –∫–ª—é—á–µ–≤—ã–º —Å–æ–±—ã—Ç–∏–µ–º –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–µ–≥–∏–æ–Ω–∞."
            }
        ];
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.quizContainer = document.querySelector('.quiz-container');
        this.nextBtn = document.querySelector('.next-btn');
        this.progressElement = document.querySelector('.progress');

        this.nextBtn.addEventListener('click', () => this.nextQuestion());
        this.loadQuestion();
    }

    loadQuestion() {
        this.quizContainer.innerHTML = '';
        const question = this.questions[this.currentQuestionIndex];
        const questionElement = document.createElement('div');
        questionElement.className = 'question-container';
        questionElement.innerHTML = `
            <img src="${question.image}" class="question-image">
            <div class="question-text">${question.question}</div>
            <div class="answers-container">
                ${question.answers.map((answer, index) => `
                    <div class="answer" data-index="${index}">
                        <div class="answer-text">${answer.text}</div>
                        <div class="feedback"></div>
                    </div>
                `).join('')}
            </div>
        `;

        questionElement.querySelectorAll('.answer').forEach(answer => {
            answer.addEventListener('click', (e) => this.handleAnswerClick(e));
        });

        this.quizContainer.appendChild(questionElement);
        this.updateProgress();
    }

    handleAnswerClick(e) {
        if (document.querySelector('.selected')) return;

        const selectedAnswer = e.currentTarget;
        const correctIndex = this.questions[this.currentQuestionIndex].correctIndex;
        const isCorrect = parseInt(selectedAnswer.dataset.index) === correctIndex;
        const feedback = selectedAnswer.querySelector('.feedback');

        selectedAnswer.classList.add(isCorrect ? 'correct' : 'incorrect', 'selected');

        if (!isCorrect) {
            const correctAnswer = this.questions[this.currentQuestionIndex].answers[correctIndex].text;
            const correctAnswerExplanation = this.questions[this.currentQuestionIndex].explanation;
            feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}. ${correctAnswerExplanation}`;
        } else {
            this.score++;
            feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç!';
        }

        this.nextBtn.style.display = 'block';
    }

    nextQuestion() {
        if (this.currentQuestionIndex < this.questions.length - 1) {
            this.currentQuestionIndex++;
            this.loadQuestion();
            this.nextBtn.style.display = 'none';
            this.nextBtn.textContent = this.currentQuestionIndex === this.questions.length - 1
                ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç!'
                : '–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É  ‚û°';
        } else {
            this.showResults();
        }
    }

    updateProgress() {
        this.progressElement.textContent = `–í–æ–ø—Ä–æ—Å ${this.currentQuestionIndex + 1}/${this.questions.length}`;
    }

    showResults() {
        this.quizContainer.innerHTML = `
            <div class="results-container">
                <h2>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! üéâ</h2>
                <p>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${this.score}/${this.questions.length}</p>
                <p>${this.getFinalMessage()}</p>
                <a href='https://domaintest-byte.github.io/yarkremlin-quiz/quizyaroslavl/main/' style='color: black;'>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
            </div>
        `;
        this.nextBtn.style.display = 'none';
    }

    getFinalMessage() {
        const percentage = (this.score / this.questions.length) * 100;
        if (percentage === 100) return '–ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç!';
        if (percentage > 70) return '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        return '–ï—Å—Ç—å –∫—É–¥–∞ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑!';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
document.addEventListener('DOMContentLoaded', () => new Quiz());
