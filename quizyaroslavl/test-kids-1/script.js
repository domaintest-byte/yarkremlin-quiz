class Quiz {
    constructor() {
        this.questions = [
            {
                "question": "–¢–∞–π–Ω–∞ —Å—Ç–∞—Ä–∏–Ω–Ω–æ–π –∏–∫–æ–Ω—ã: –ö–∞–∫–æ–µ —á—É–¥–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ –º—É–∑–µ–µ? –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã –∏—â–µ—à—å –≤–æ–ª—à–µ–±–Ω—ã–π –∞—Ä—Ç–µ—Ñ–∞–∫—Ç —Å —Å–∏—è—é—â–∏–º –ª–∏–∫–æ–º. –ß—Ç–æ —ç—Ç–æ?",
                "image": "",
                "answers": [
                    {"text": "–ò–∫–æ–Ω–∞ –ù–∏–∫–æ–ª–∞—è –ß—É–¥–æ—Ç–≤–æ—Ä—Ü–∞ —Å –∞–ª–º–∞–∑–∞–º–∏"},
                    {"text": "–ò–∫–æ–Ω–∞ –°–ø–∞—Å–∞ –í—Å–µ–¥–µ—Ä–∂–∏—Ç–µ–ª—è XIII –≤–µ–∫–∞"},
                    {"text": "–ß—É–¥–æ—Ç–≤–æ—Ä–Ω–∞—è –∏–∫–æ–Ω–∞ –§—ë–¥–æ—Ä–æ–≤—Å–∫–æ–π –ë–æ–∂—å–µ–π –ú–∞—Ç–µ—Ä–∏"},
                    {"text": "–ò–∫–æ–Ω–∞ –¢—Ä–æ–∏—Ü—ã –ê–Ω–¥—Ä–µ—è –†—É–±–ª—ë–≤–∞"}
                ],
                "correctIndex": 1,
                "explanation": "–ò–∫–æ–Ω–∞ –°–ø–∞—Å–∞ –í—Å–µ–¥–µ—Ä–∂–∏—Ç–µ–ª—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∞ —è—Ä–∫–æ—Å—Ç—å –∫—Ä–∞—Å–æ–∫ –∑–∞ 800 –ª–µ—Ç, –∑–∞ —á—Ç–æ –µ—ë –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–∂–∏–≤–æ–π¬ª."
            },
            {
                "question": "–ó–∞–≥–∞–¥–∫–∞ –º–æ–Ω–∞—Å—Ç—ã—Ä—Å–∫–æ–π –∫—É—Ö–Ω–∏: –ß—Ç–æ –µ–ª–∏ –≤–æ–∏–Ω—ã –ø–µ—Ä–µ–¥ –±–∏—Ç–≤–æ–π? –ï—Å–ª–∏ –±—ã —Ç—ã –±—ã–ª –±–æ–≥–∞—Ç—ã—Ä—ë–º, –∫–∞–∫–æ–µ –±–ª—é–¥–æ –∑–∞—Ä—è–¥–∏–ª–æ –±—ã —Ç–µ–±—è —Å–∏–ª–æ–π?",
                "image": "",
                "answers": [
                    {"text": "–ö–∞—Ä—Ç–æ—Ñ–µ–ª—å —Å —Å–µ–ª—ë–¥–∫–æ–π"},
                    {"text": "–ü–µ–ª—å–º–µ–Ω–∏ —Å –º—è—Å–æ–º –º–∞–º–æ–Ω—Ç–∞"},
                    {"text": "–ë—É—Ä–≥–µ—Ä—ã —Å –∫–≤–∞—Å–æ–º"},
                    {"text": "–ö–∞—à–∞ —Å —Ç–æ–ø–ª—ë–Ω—ã–º –º–∞—Å–ª–æ–º –∏ –º—ë–¥–æ–º"}
                ],
                "correctIndex": 3,
                "explanation": "–ö–∞—à—É –≤–∞—Ä–∏–ª–∏ –≤ –≥–∏–≥–∞–Ω—Ç—Å–∫–∏—Ö –∫–æ—Ç–ª–∞—Ö, —á—Ç–æ–±—ã –Ω–∞–∫–æ—Ä–º–∏—Ç—å –≤–µ—Å—å –æ—Ç—Ä—è–¥."
            },
            {
                "question": "–ó–≤–µ—Ä–∏–Ω—ã–π –∫–æ–¥: –ö–∞–∫–æ–µ –∂–∏–≤–æ—Ç–Ω–æ–µ —É–∫—Ä–∞—à–∞–µ—Ç –≥–µ—Ä–± –º—É–∑–µ—è? –†–∞–∑–≥–∞–¥–∞–π —Å–∏–º–≤–æ–ª: –∫—Ç–æ –æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–æ–∫—Ä–æ–≤–∏—â–∞ –º—É–∑–µ—è?",
                "image": "",
                "answers": [
                    {"text": "–î–≤—É–≥–ª–∞–≤—ã–π –æ—Ä—ë–ª"},
                    {"text": "–ó–æ–ª–æ—Ç–∞—è —Ä—ã–±–∫–∞"},
                    {"text": "–í–æ–ª–∫ –≤ –∫–æ—Ä–æ–Ω–µ"},
                    {"text": "–ú–µ–¥–≤–µ–¥—å —Å —Å–µ–∫–∏—Ä–æ–π"}
                ],
                "correctIndex": 3,
                "explanation": "–ú–µ–¥–≤–µ–¥—å —Å —Å–µ–∫–∏—Ä–æ–π ‚Äî –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π —Å–∏–º–≤–æ–ª –Ø—Ä–æ—Å–ª–∞–≤–ª—è, –∏–∑–æ–±—Ä–∞–∂—ë–Ω–Ω—ã–π –Ω–∞ –≥–µ—Ä–±–µ –º—É–∑–µ—è."
            },
            {
                "question": "–ß—Ç–æ –Ω–∞–¥–µ–≤–∞–ª –Ω–∞ —Å–µ–±—è –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–∏–π –≤–æ–∏–Ω?",
                "image": "./source/vopros (8).jpg",
                "answers": [
                    {"text": "–ö–æ—Å—Ç—é–º –∫–æ—Å–º–æ–Ω–∞–≤—Ç–∞"},
                    {"text": "–ú–µ—Ö–æ–≤—É—é –∂–∏–ª–µ—Ç–∫—É"},
                    {"text": "–®–∞–ø–∫—É –∏ —Å–≤–∏—Ç–µ—Ä"},
                    {"text": "–ö–æ–ª—å—á—É–≥—É –∏ —à–ª–µ–º"}
                ],
                "correctIndex": 3,
                "explanation": "–¢–∞–∫–∏–µ –¥–æ—Å–ø–µ—Ö–∏ –∑–∞—â–∏—â–∞–ª–∏ –≤–æ–∏–Ω–æ–≤ –≤–æ –≤—Ä–µ–º—è –ø–æ—Ö–æ–¥–∞ –∫–Ω—è–∑—è –ò–≥–æ—Ä—è."
            },
            {
                "question": "–ß—Ç–æ –∑–∞—â–∏—â–∞–ª–∏ –≤–æ–æ—Ä—É–∂–µ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã –Ø—Ä–æ—Å–ª–∞–≤–ª—è?",
                "image": "",
                "answers": [
                    {"text": "–ì–æ—Ä–æ–¥ –æ—Ç –Ω–∞–≤–æ–¥–Ω–µ–Ω–∏–π"},
                    {"text": "–ì–æ—Ä–æ–¥ –æ—Ç –ø–æ–∂–∞—Ä–æ–≤"},
                    {"text": "–ì–æ—Ä–æ–¥ –æ—Ç –≤—Ä–∞–≥–æ–≤"},
                    {"text": "–ì–æ—Ä–æ–¥ –æ—Ç —Ä–∞–∑—Ä—É—à–µ–Ω–∏–π"}
                ],
                "correctIndex": 2,
                "explanation": "–í–æ–æ—Ä—É–∂–µ–Ω–Ω—ã–µ —Å—Ç–µ–Ω—ã –Ø—Ä–æ—Å–ª–∞–≤–ª—è –±—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –¥–ª—è –∑–∞—â–∏—Ç—ã –≥–æ—Ä–æ–¥–∞ –æ—Ç –≤—Ä–∞–≥–æ–≤ –∏ –Ω–∞–ø–∞–¥–µ–Ω–∏–π. –û–Ω–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–ª–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∂–∏—Ç–µ–ª–µ–π."
            },
            {
                "question": "–ö–∞–∫–æ–π –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π –º–µ–¥–≤–µ–¥—å –∂–∏–≤—ë—Ç –≤ –º—É–∑–µ–µ-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫–µ?",
                "image": "",
                "answers": [
                    {"text": "–ú–µ–¥–≤–µ–¥–∏—Ü–∞ –ö—Å—é—à–∞"},
                    {"text": "–ú–µ–¥–≤–µ–¥–∏—Ü–∞ –°–æ–Ω—è"},
                    {"text": "–ú–µ–¥–≤–µ–¥–∏—Ü–∞ –ù–∞—Å—Ç—è"},
                    {"text": "–ú–µ–¥–≤–µ–¥–∏—Ü–∞ –ú–∞—à–∞"}
                ],
                "correctIndex": 3,
                "explanation": "–ú–µ–¥–≤–µ–¥–∏—Ü–∞ –ú–∞—à–∞ ‚Äî –∑–Ω–∞–º–µ–Ω–∏—Ç—ã–π –∂–∏–≤–æ–π —Å–∏–º–≤–æ–ª –º—É–∑–µ—è-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫–∞, —Å–æ–¥–µ—Ä–∂–∞—â–∏–π—Å—è –Ω–∞ –µ–≥–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏."
            }
        ];
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.quizContainer = document.querySelector('.quiz-container');
        this.nextBtn = document.querySelector('.next-btn');
        this.progressElement = document.querySelector('.progress');

        this.nextBtn.addEventListener('click', () => this.nextQuestion());
        this.loadQuestion();
    }

    loadQuestion() {
        this.quizContainer.innerHTML = '';
        const question = this.questions[this.currentQuestionIndex];
        const questionElement = document.createElement('div');
        questionElement.className = 'question-container';
        questionElement.innerHTML = `
            <img src="${question.image}" class="question-image">
            <div class="question-text">${question.question}</div>
            <div class="answers-container">
                ${question.answers.map((answer, index) => `
                    <div class="answer" data-index="${index}">
                        <div class="answer-text">${answer.text}</div>
                        <div class="feedback"></div>
                    </div>
                `).join('')}
            </div>
        `;

        questionElement.querySelectorAll('.answer').forEach(answer => {
            answer.addEventListener('click', (e) => this.handleAnswerClick(e));
        });

        this.quizContainer.appendChild(questionElement);
        this.updateProgress();
    }

    handleAnswerClick(e) {
        if (document.querySelector('.selected')) return;

        const selectedAnswer = e.currentTarget;
        const correctIndex = this.questions[this.currentQuestionIndex].correctIndex;
        const isCorrect = parseInt(selectedAnswer.dataset.index) === correctIndex;
        const feedback = selectedAnswer.querySelector('.feedback');

        selectedAnswer.classList.add(isCorrect ? 'correct' : 'incorrect', 'selected');

        if (!isCorrect) {
            const correctAnswer = this.questions[this.currentQuestionIndex].answers[correctIndex].text;
            const correctAnswerExplanation = this.questions[this.currentQuestionIndex].explanation;
            feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}. ${correctAnswerExplanation}`;
        } else {
            this.score++;
            feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç!';
        }

        this.nextBtn.style.display = 'block';
    }

    nextQuestion() {
        if (this.currentQuestionIndex < this.questions.length - 1) {
            this.currentQuestionIndex++;
            this.loadQuestion();
            this.nextBtn.style.display = 'none';
            this.nextBtn.textContent = this.currentQuestionIndex === this.questions.length - 1
                ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç!'
                : '–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É  ‚û°';
        } else {
            this.showResults();
        }
    }

    updateProgress() {
        this.progressElement.textContent = `–í–æ–ø—Ä–æ—Å ${this.currentQuestionIndex + 1}/${this.questions.length}`;
    }

    showResults() {
        this.quizContainer.innerHTML = `
            <div class="results-container">
                <h2>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! üéâ</h2>
                <p>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${this.score}/${this.questions.length}</p>
                <p>${this.getFinalMessage()}</p>
                <a href='https://domaintest-byte.github.io/yarkremlin-quiz/quizyaroslavl/main/' style='color: black;'>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
            </div>
        `;
        this.nextBtn.style.display = 'none';
    }

    getFinalMessage() {
        const percentage = (this.score / this.questions.length) * 100;
        if (percentage === 100) return '–ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç!';
        if (percentage > 70) return '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        return '–ï—Å—Ç—å –∫—É–¥–∞ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑!';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
document.addEventListener('DOMContentLoaded', () => new Quiz());
