class Quiz {
    constructor() {
        this.questions = [
            {
                "question": "–ì–¥–µ, –ø–æ —Å–ª–æ–≤–∞–º –ú—É—Å–∏–Ω–∞-–ü—É—à–∫–∏–Ω–∞, –±—ã–ª –ø—Ä–∏–æ–±—Ä–µ—Ç—ë–Ω —Å–±–æ—Ä–Ω–∏–∫ —Å ¬´–°–ª–æ–≤–æ–º –æ –ø–æ–ª–∫—É –ò–≥–æ—Ä–µ–≤–µ¬ª?",
                "image": "./source/vopros (1).jpg",
                "answers": [
                    {"text": "–í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –ê–∫–∞–¥–µ–º–∏–∏ –Ω–∞—É–∫"},
                    {"text": "–í –¥–æ–º–µ –∫–Ω–∏–≥–æ—Ç–æ—Ä–≥–æ–≤—Ü–∞ –≤ –ú–æ—Å–∫–≤–µ"},
                    {"text": "–í –°–ø–∞—Å–æ-–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–æ–º –º–æ–Ω–∞—Å—Ç—ã—Ä–µ –≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ"},
                    {"text": "–í –¢—Ä–æ–∏—Ü–µ-–°–µ—Ä–≥–∏–µ–≤–æ–π –ª–∞–≤—Ä–µ"}
                ],
                "correctIndex": 2,
                "explanation": "–ú—É—Å–∏–Ω-–ü—É—à–∫–∏–Ω —É—Ç–≤–µ—Ä–∂–¥–∞–ª, —á—Ç–æ –Ω–∞—à—ë–ª —Å–±–æ—Ä–Ω–∏–∫ –∏–º–µ–Ω–Ω–æ –≤ –°–ø–∞—Å–æ-–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–æ–º –º–æ–Ω–∞—Å—Ç—ã—Ä–µ –≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ."
            },
            {
                "question": "–ß—Ç–æ –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω–æ–≥–æ –≤ —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∏–∑ –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ú—É—Å–∏–Ω–∞-–ü—É—à–∫–∏–Ω–∞ –∏ –∏–º–µ–µ—Ç –æ—Å–æ–±—É—é —Ü–µ–Ω–Ω–æ—Å—Ç—å?",
                "image": "./source/vopros (2).jpg",
                "answers": [
                    {"text": "–ö–æ–ø—å—ë –∫–Ω—è–∑—è –ò–≥–æ—Ä—è"},
                    {"text": "–ï–≤–∞–Ω–≥–µ–ª–∏–µ –Ω–∞—á–∞–ª–∞ XVII –≤–µ–∫–∞"},
                    {"text": "–ó–æ–ª–æ—Ç–æ–µ –∫–æ–ª—å—Ü–æ"},
                    {"text": "–ö–∞–º–µ–Ω–Ω—ã–π –∫—Ä–µ—Å—Ç"}
                ],
                "correctIndex": 1,
                "explanation": "–ï–≤–∞–Ω–≥–µ–ª–∏–µ –∏–∑ —É—Å–∞–¥—å–±—ã –ò–ª–æ–≤–Ω–∞ ‚Äî —Ä–µ–¥–∫–∏–π –ø–∞–º—è—Ç–Ω–∏–∫ –¥—É—Ö–æ–≤–Ω–æ–π –∫—É–ª—å—Ç—É—Ä—ã –∏ —á–∞—Å—Ç—å –ª–∏—á–Ω–æ–π –∫–æ–ª–ª–µ–∫—Ü–∏–∏ –ê. –ò. –ú—É—Å–∏–Ω–∞-–ü—É—à–∫–∏–Ω–∞."
            },
            {
                "question": "–í –∫–∞–∫–∏—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —ç–∫—Å–ø–æ–∑–∏—Ü–∏—è ¬´–°–ª–æ–≤–∞¬ª?",
                "image": "./source/vopros (3).jpg",
                "answers": [
                    {"text": "–í –∫–æ–ª–æ–∫–æ–ª—å–Ω–µ"},
                    {"text": "–í –ø–æ–¥–∑–µ–º–µ–ª—å—è—Ö"},
                    {"text": "–í —Ç—Ä–∞–ø–µ–∑–Ω–æ–π –ø–∞–ª–∞—Ç–µ –∏ –Ω–∞—Å—Ç–æ—è—Ç–µ–ª—å—Å–∫–∏—Ö –ø–æ–∫–æ—è—Ö"},
                    {"text": "–í –Ω–æ–≤–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ–º –∫–æ—Ä–ø—É—Å–µ"}
                ],
                "correctIndex": 2,
                "explanation": "–í—ã—Å—Ç–∞–≤–∫–∞ —Ä–∞–∑–º–µ—â–µ–Ω–∞ –≤ –ø–æ–¥–ª–∏–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—å–µ—Ä–∞—Ö XVI –≤–µ–∫–∞ ‚Äî –∏–º–µ–Ω–Ω–æ —ç—Ç–æ —Å–æ–∑–¥–∞—ë—Ç –æ—â—É—â–µ–Ω–∏–µ –ø–æ–≥—Ä—É–∂–µ–Ω–∏—è –≤ —ç–ø–æ—Ö—É."
            },
            {
                "question": "–ò—Å—Ö–æ–¥—è –∏–∑ –æ–±—â–µ–π —ç—Ä—É–¥–∏—Ü–∏–∏ –∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–Ω—ã—Ö —ç–∫—Å–ø–æ–Ω–∞—Ç–æ–≤, –∫–∞–∫–æ–µ –∂–µ–Ω—Å–∫–æ–µ –∏–º—è –≤—Å—Ç—Ä–µ—á–∞–µ—Ç—Å—è –≤ ¬´–°–ª–æ–≤–µ¬ª?",
                "image": "./source/vopros (4).jpg",
                "answers": [
                    {"text": "–ú–∞—Ä—Ñ–∞"},
                    {"text": "–Ø—Ä–æ—Å–ª–∞–≤–Ω–∞"},
                    {"text": "–î–∞—Ä—å—è"},
                    {"text": "–û–ª—å–≥–∞"}
                ],
                "correctIndex": 1,
                "explanation": "–Ø—Ä–æ—Å–ª–∞–≤–Ω–∞ ‚Äî –æ–¥–∏–Ω –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö –æ–±—Ä–∞–∑–æ–≤ –ø–æ—ç–º—ã, –æ—Ç—Ä–∞–∂—ë–Ω–Ω—ã–π –≤ —Ö—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–º –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–∏ —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏. –ù–∞–¥–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –Ω–µ –∏–º—è, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ —É–ø–æ–º—è–Ω—É—Ç–æ –≤ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏, –∞ –æ—Ç—á–µ—Å—Ç–≤–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞."
            },
            {
                "question": "–ö–∞–∫–∞—è —Å—É–¥—å–±–∞ –ø–æ—Å—Ç–∏–≥–ª–∞ —Ä—É–∫–æ–ø–∏—Å—å –ø–æ—Å–ª–µ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏?",
                "image": "./source/vopros (5).jpg",
                "answers": [
                    {"text": "–ï—ë —Å–æ–∂–≥–ª–∏ –ø—Ä–∏ –ó–æ–ª–æ—Ç–æ–π –û—Ä–¥–µ"},
                    {"text": "–ï—ë –æ—Ç–ø—Ä–∞–≤–∏–ª–∏ –≤ –ü–µ—Ç–µ—Ä–±—É—Ä–≥"},
                    {"text": "–ï—ë –ø–æ—Ö–∏—Ç–∏–ª–∏ –∏–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ –∞–≥–µ–Ω—Ç—ã"},
                    {"text": "–û–Ω–∞ –ø–æ–≥–∏–±–ª–∞ –≤ –ø–æ–∂–∞—Ä–µ –ú–æ—Å–∫–≤—ã 1812 –≥–æ–¥–∞"}
                ],
                "correctIndex": 3,
                "explanation": "–†—É–∫–æ–ø–∏—Å—å —Ö—Ä–∞–Ω–∏–ª–∞—Å—å —É –ú—É—Å–∏–Ω–∞-–ü—É—à–∫–∏–Ω–∞ –∏ –±—ã–ª–∞ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∞ –≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–º –ø–æ–∂–∞—Ä–µ –ø—Ä–∏ –Ω–∞—à–µ—Å—Ç–≤–∏–∏ –ù–∞–ø–æ–ª–µ–æ–Ω–∞."
            },
            {
                "question": "–ß—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å –≤ —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏ –∫–∞–∫ —á–∞—Å—Ç—å –≤–æ–µ–Ω–Ω–æ–≥–æ —Å–Ω–∞—Ä—è–∂–µ–Ω–∏—è XII –≤–µ–∫–∞?",
                "image": "./source/vopros (6).jpg",
                "answers": [
                    {"text": "–ë—Ä–æ–Ω–µ–∂–∏–ª–µ—Ç"},
                    {"text": "–ì—É—Å–∞—Ä—Å–∫–∏–µ –¥–æ—Å–ø–µ—Ö–∏"},
                    {"text": "–ö–æ–ª—å—á—É–≥–∏ –∏ —à–ª–µ–º–∞"},
                    {"text": "–°—Ç—Ä–µ–ª–∫–æ–≤–æ–µ –æ—Ä—É–∂–∏–µ"}
                ],
                "correctIndex": 2,
                "explanation": "–í –º—É–∑–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã —Ä–µ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –Ω–∞—Å—Ç–æ—è—â–µ–π –¥—Ä—É–∂–∏–Ω–Ω–æ–π —ç–∫–∏–ø–∏—Ä–æ–≤–∫–∏ –≤—Ä–µ–º—ë–Ω –ø–æ—Ö–æ–¥–∞ –∫–Ω—è–∑—è –ò–≥–æ—Ä—è."
            },
            {
                "question": "–ö—Ç–æ –±—ã–ª –≥–ª–∞–≤–Ω—ã–º —Å–æ–±–∏—Ä–∞—Ç–µ–ª–µ–º —Ä—É—Å—Å–∫–∏—Ö –¥—Ä–µ–≤–Ω–æ—Å—Ç–µ–π –∏ –Ω–∞—à—ë–ª ¬´–°–ª–æ–≤–æ¬ª?",
                "image": "./source/vopros (7).jpg",
                "answers": [
                    {"text": "–ò–≤–∞–Ω –ì—Ä–æ–∑–Ω—ã–π"},
                    {"text": "–ê–ª–µ–∫—Å–∞–Ω–¥—Ä –ü—É—à–∫–∏–Ω"},
                    {"text": "–ê–ª–µ–∫—Å–µ–π –ú—É—Å–∏–Ω-–ü—É—à–∫–∏–Ω"},
                    {"text": "–í–ª–∞–¥–∏–º–∏—Ä –£–ª—å—è–Ω–æ–≤"}
                ],
                "correctIndex": 2,
                "explanation": "–ú—É—Å–∏–Ω-–ü—É—à–∫–∏–Ω –±—ã–ª –∫–æ–ª–ª–µ–∫—Ü–∏–æ–Ω–µ—Ä–æ–º –¥—Ä–µ–≤–Ω–æ—Å—Ç–µ–π –∏ –Ω–∞—à—ë–ª —Å–±–æ—Ä–Ω–∏–∫ —Å –ø–æ—ç–º–æ–π."
            }
        ];
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.quizContainer = document.querySelector('.quiz-container');
        this.nextBtn = document.querySelector('.next-btn');
        this.progressElement = document.querySelector('.progress');

        this.nextBtn.addEventListener('click', () => this.nextQuestion());
        this.loadQuestion();
    }

    loadQuestion() {
        this.quizContainer.innerHTML = '';
        const question = this.questions[this.currentQuestionIndex];
        const questionElement = document.createElement('div');
        questionElement.className = 'question-container';
        questionElement.innerHTML = `
            <img src="${question.image}" class="question-image">
            <div class="question-text">${question.question}</div>
            <div class="answers-container">
                ${question.answers.map((answer, index) => `
                    <div class="answer" data-index="${index}">
                        <div class="answer-text">${answer.text}</div>
                        <div class="feedback"></div>
                    </div>
                `).join('')}
            </div>
        `;

        questionElement.querySelectorAll('.answer').forEach(answer => {
            answer.addEventListener('click', (e) => this.handleAnswerClick(e));
        });

        this.quizContainer.appendChild(questionElement);
        this.updateProgress();
    }

    handleAnswerClick(e) {
        if (document.querySelector('.selected')) return;

        const selectedAnswer = e.currentTarget;
        const correctIndex = this.questions[this.currentQuestionIndex].correctIndex;
        const isCorrect = parseInt(selectedAnswer.dataset.index) === correctIndex;
        const feedback = selectedAnswer.querySelector('.feedback');

        selectedAnswer.classList.add(isCorrect ? 'correct' : 'incorrect', 'selected');

        if (!isCorrect) {
            const correctAnswer = this.questions[this.currentQuestionIndex].answers[correctIndex].text;
            const correctAnswerExplanation = this.questions[this.currentQuestionIndex].explanation;
            feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}. ${correctAnswerExplanation}`;
        } else {
            this.score++;
            feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç!';
        }

        this.nextBtn.style.display = 'block';
    }

    nextQuestion() {
        if (this.currentQuestionIndex < this.questions.length - 1) {
            this.currentQuestionIndex++;
            this.loadQuestion();
            this.nextBtn.style.display = 'none';
            this.nextBtn.textContent = this.currentQuestionIndex === this.questions.length - 1
                ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç!'
                : '–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É  ‚û°';
        } else {
            this.showResults();
        }
    }

    updateProgress() {
        this.progressElement.textContent = `–í–æ–ø—Ä–æ—Å ${this.currentQuestionIndex + 1}/${this.questions.length}`;
    }

    showResults() {
        this.quizContainer.innerHTML = `
            <div class="results-container">
                <h2>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! üéâ</h2>
                <p>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${this.score}/${this.questions.length}</p>
                <p>${this.getFinalMessage()}</p>
                <a href='https://domaintest-byte.github.io/yarkremlin-quiz/quizyaroslavl/main/' style='color: black;'>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
            </div>
        `;
        this.nextBtn.style.display = 'none';
    }

    getFinalMessage() {
        const percentage = (this.score / this.questions.length) * 100;
        if (percentage === 100) return '–ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç!';
        if (percentage > 70) return '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        return '–ï—Å—Ç—å –∫—É–¥–∞ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑!';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
document.addEventListener('DOMContentLoaded', () => new Quiz());
