class Quiz {
    constructor() {
        this.questions = [
            {
                "question": "–í –∫–∞–∫–æ–º –≤–µ–∫–µ –±—ã–ª –æ—Å–Ω–æ–≤–∞–Ω –°–ø–∞—Å–æ-–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–∏–π –º–æ–Ω–∞—Å—Ç—ã—Ä—å, —Å—Ç–∞–≤—à–∏–π –æ—Å–Ω–æ–≤–æ–π –º—É–∑–µ—è-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫–∞?",
                "image": "",
                "answers": [
                    {"text": "–í X –≤–µ–∫–µ"},
                    {"text": "–í XIII –≤–µ–∫–µ"},
                    {"text": "–í XIV –≤–µ–∫–µ"},
                    {"text": "–í XI –≤–µ–∫–µ"}
                ],
                "correctIndex": 1,
                "explanation": "–°–æ–±–æ—Ä –±—ã–ª –æ—Å–Ω–æ–≤–∞–Ω –≤ 1216 –≥–æ–¥—É, —Ç.–µ. –≤ XIII –≤–µ–∫–µ –∫–Ω—è–∑–µ–º –†–æ—Å—Ç–æ–≤—Å–∫–∏–º –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–º –í—Å–µ–≤–æ–ª–æ–¥–æ–≤–∏—á–µ–º."
            },
            {
                "question": "–ö–∞–∫–æ–µ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –±—ã–ª–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ –≤ —Å—Ç–µ–Ω–∞—Ö –º–æ–Ω–∞—Å—Ç—ã—Ä—è?",
                "image": "",
                "answers": [
                    {"text": "–õ–∞–≤—Ä–µ–Ω—Ç—å–µ–≤—Å–∫–∞—è –ª–µ—Ç–æ–ø–∏—Å—å"},
                    {"text": "–í–µ–ª–∏–∫–∏–µ –ß–µ—Ç—å–∏-–ú–∏–Ω–µ–∏"},
                    {"text": "¬´–°–ª–æ–≤–æ –æ –ø–æ–ª–∫—É –ò–≥–æ—Ä–µ–≤–µ¬ª"},
                    {"text": "¬´–°–ª–æ–≤–æ –æ –∑–∞–∫–æ–Ω–µ –∏ –±–ª–∞–≥–æ–¥–∞—Ç–∏¬ª"}
                ],
                "correctIndex": 2,
                "explanation": "¬´–°–ª–æ–≤–æ –æ –ø–æ–ª–∫—É –ò–≥–æ—Ä–µ–≤–µ¬ª ‚Äî –ø–∞–º—è—Ç–Ω–∏–∫ –¥—Ä–µ–≤–Ω–µ—Ä—É—Å—Å–∫–æ–π –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—ã –∫–æ–Ω—Ü–∞ XII –≤–µ–∫–∞. –†—É–∫–æ–ø–∏—Å—å –±—ã–ª–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –≤ XVIII –≤–µ–∫–µ –≤ –°–ø–∞—Å–æ-–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–æ–º –º–æ–Ω–∞—Å—Ç—ã—Ä–µ –≤ –Ø—Ä–æ—Å–ª–∞–≤–ª–µ."
            },
            {
                "question": "–ö—Ç–æ –∏–∑ –≥–µ—Ä–æ–µ–≤ –°–º—É—Ç–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª –∑–¥–µ—Å—å —Å–±–æ—Ä –Ω–∞—Ä–æ–¥–Ω–æ–≥–æ –æ–ø–æ–ª—á–µ–Ω–∏—è –≤ 1612 –≥–æ–¥—É?",
                "image": "",
                "answers": [
                    {"text": "–í–∞—Å–∏–ª–∏–π –ì–æ–ª–∏—Ü—ã–Ω –∏ –°–∏–º–µ–æ–Ω –ë–µ–∫–±—É–ª–∞—Ç–æ–≤–∏—á"},
                    {"text": "–ö—É–∑—å–º–∞ –ú–∏–Ω–∏–Ω –∏ –î–º–∏—Ç—Ä–∏–π –ü–æ–∂–∞—Ä—Å–∫–∏–π"},
                    {"text": "–ú–∏—Ö–∞–∏–ª –°–∫–æ–ø–∏–Ω-–®—É–π—Å–∫–∏–π –∏ –î–º–∏—Ç—Ä–∏–π –®—É–π—Å–∫–∏–π"},
                    {"text": "–ü—Ä–æ–∫–æ–ø–∏–π –õ—è–ø—É–Ω–æ–≤, –ò–≤–∞–Ω –ó–∞—Ä—É—Ü–∫–∏–π –∏ –∫–Ω—è–∑—å –î–º–∏—Ç—Ä–∏–π –¢—Ä—É–±–µ—Ü–∫–æ–π"}
                ],
                "correctIndex": 1,
                "explanation": "–í 1612 –≥–æ–¥—É –ö—É–∑—å–º–∞ –ú–∏–Ω–∏–Ω –∏ –î–º–∏—Ç—Ä–∏–π –ü–æ–∂–∞—Ä—Å–∫–∏–π –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª–∏ –í—Ç–æ—Ä–æ–µ –Ω–∞—Ä–æ–¥–Ω–æ–µ –æ–ø–æ–ª—á–µ–Ω–∏–µ, –æ—Å–≤–æ–±–æ–¥–∏–≤—à–µ–µ –ú–æ—Å–∫–≤—É –æ—Ç –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ç–æ–≤."
            },
            {
                "question": "–ö–∞–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–∞–º–∞—è –≤—ã—Å–æ–∫–∞—è –±–∞—à–Ω—è –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –º—É–∑–µ—è, —Å –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–∞–Ω–æ—Ä–∞–º–Ω—ã–π –≤–∏–¥ –Ω–∞ –Ø—Ä–æ—Å–ª–∞–≤–ª—å?",
                "image": "",
                "answers": [
                    {"text": "–ë–æ–≥–æ—è–≤–ª–µ–Ω—Å–∫–∞—è –±–∞—à–Ω—è"},
                    {"text": "–°–≤—è—Ç—ã–µ –≤–æ—Ä–æ—Ç–∞"},
                    {"text": "–ó–≤–æ–Ω–Ω–∏—Ü–∞ –°–ø–∞—Å–æ-–ü—Ä–µ–æ–±—Ä–∞–∂–µ–Ω—Å–∫–æ–≥–æ –º–æ–Ω–∞—Å—Ç—ã—Ä—è"},
                    {"text": "–ë–æ–≥–æ—Ä–æ–¥–∏—Ü–∫–∞—è –±–∞—à–Ω—è"}
                ],
                "correctIndex": 2,
                "explanation": "–ó–≤–æ–Ω–Ω–∏—Ü–∞ XVI‚ÄìXIX –≤–µ–∫–æ–≤ —Å–ª—É–∂–∏—Ç —Å–º–æ—Ç—Ä–æ–≤–æ–π –ø–ª–æ—â–∞–¥–∫–æ–π —Å –≤–∏–¥–æ–º –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫—É—é —á–∞—Å—Ç—å –Ø—Ä–æ—Å–ª–∞–≤–ª—è."
            },
            {
                "question": "–ü—Ä–∏ –∫–∞–∫–æ–º –∫–Ω—è–∑–µ –†–æ—Å—Ç–æ–≤—Å–∫–æ–º –±—ã–ª –∑–∞–ª–æ–∂–µ–Ω —Å—Ç–∞—Ä–µ–π—à–∏–π —Ö—Ä–∞–º –Ø—Ä–æ—Å–ª–∞–≤–ª—è, –Ω–∞—Ö–æ–¥—è—â–∏–π—Å—è –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –º—É–∑–µ—è-–∑–∞–ø–æ–≤–µ–¥–Ω–∏–∫–∞?",
                "image": "",
                "answers": [
                    {"text": "–í—Å–µ–≤–æ–ª–æ–¥ –Æ—Ä—å–µ–≤–∏—á –ë–æ–ª—å—à–æ–µ –ì–Ω–µ–∑–¥–æ"},
                    {"text": "–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω –í—Å–µ–≤–æ–ª–æ–¥–æ–≤–∏—á"},
                    {"text": "–í–∞—Å–∏–ª–∏–π III –ò–≤–∞–Ω–æ–≤–∏—á"},
                    {"text": "–í–ª–∞–¥–∏–º–∏—Ä –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–≤–∏—á"}
                ],
                "correctIndex": 1,
                "explanation": "–õ–∞–≤—Ä–µ–Ω—Ç—å–µ–≤—Å–∫–∞—è –ª–µ—Ç–æ–ø–∏—Å—å —É–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –º–æ–Ω–∞—Å—Ç—ã—Ä—å –∑–∞–ª–æ–∂–µ–Ω –≤ 1216 –≥–æ–¥—É –∫–Ω—è–∑–µ–º –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏–Ω–æ–º –í—Å–µ–≤–æ–ª–æ–¥–æ–≤–∏—á–µ–º."
            }
        ];
        this.currentQuestionIndex = 0;
        this.score = 0;
        this.quizContainer = document.querySelector('.quiz-container');
        this.nextBtn = document.querySelector('.next-btn');
        this.progressElement = document.querySelector('.progress');

        this.nextBtn.addEventListener('click', () => this.nextQuestion());
        this.loadQuestion();
    }

    loadQuestion() {
        this.quizContainer.innerHTML = '';
        const question = this.questions[this.currentQuestionIndex];
        const questionElement = document.createElement('div');
        questionElement.className = 'question-container';
        questionElement.innerHTML = `
            <img src="${question.image}" class="question-image">
            <div class="question-text">${question.question}</div>
            <div class="answers-container">
                ${question.answers.map((answer, index) => `
                    <div class="answer" data-index="${index}">
                        <div class="answer-text">${answer.text}</div>
                        <div class="feedback"></div>
                    </div>
                `).join('')}
            </div>
        `;

        questionElement.querySelectorAll('.answer').forEach(answer => {
            answer.addEventListener('click', (e) => this.handleAnswerClick(e));
        });

        this.quizContainer.appendChild(questionElement);
        this.updateProgress();
    }

    handleAnswerClick(e) {
        if (document.querySelector('.selected')) return;

        const selectedAnswer = e.currentTarget;
        const correctIndex = this.questions[this.currentQuestionIndex].correctIndex;
        const isCorrect = parseInt(selectedAnswer.dataset.index) === correctIndex;
        const feedback = selectedAnswer.querySelector('.feedback');

        selectedAnswer.classList.add(isCorrect ? 'correct' : 'incorrect', 'selected');

        if (!isCorrect) {
            const correctAnswer = this.questions[this.currentQuestionIndex].answers[correctIndex].text;
            const correctAnswerExplanation = this.questions[this.currentQuestionIndex].explanation;
            feedback.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}. ${correctAnswerExplanation}`;
        } else {
            this.score++;
            feedback.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω—ã–π –æ—Ç–≤–µ—Ç!';
        }

        this.nextBtn.style.display = 'block';
    }

    nextQuestion() {
        if (this.currentQuestionIndex < this.questions.length - 1) {
            this.currentQuestionIndex++;
            this.loadQuestion();
            this.nextBtn.style.display = 'none';
            this.nextBtn.textContent = this.currentQuestionIndex === this.questions.length - 1
                ? '–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç!'
                : '–ü–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –≤–æ–ø—Ä–æ—Å—É  ‚û°';
        } else {
            this.showResults();
        }
    }

    updateProgress() {
        this.progressElement.textContent = `–í–æ–ø—Ä–æ—Å ${this.currentQuestionIndex + 1}/${this.questions.length}`;
    }

    showResults() {
        this.quizContainer.innerHTML = `
            <div class="results-container">
                <h2>–¢–µ—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω! üéâ</h2>
                <p>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç: ${this.score}/${this.questions.length}</p>
                <p>${this.getFinalMessage()}</p>
                <a href='https://domaintest-byte.github.io/yarkremlin-quiz/quizyaroslavl/main/' style='color: black;'>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É</a>
            </div>
        `;
        this.nextBtn.style.display = 'none';
    }

    getFinalMessage() {
        const percentage = (this.score / this.questions.length) * 100;
        if (percentage === 100) return '–ò–¥–µ–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –í—ã –Ω–∞—Å—Ç–æ—è—â–∏–π —ç–∫—Å–ø–µ—Ä—Ç!';
        if (percentage > 70) return '–•–æ—Ä–æ—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!';
        return '–ï—Å—Ç—å –∫—É–¥–∞ —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç –µ—â–µ —Ä–∞–∑!';
    }
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–∞
document.addEventListener('DOMContentLoaded', () => new Quiz());
